<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://chenzdna.github.io</id>
    <title>é˜¿å¾DNA</title>
    <updated>2022-04-27T05:08:52.953Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://chenzdna.github.io"/>
    <link rel="self" href="https://chenzdna.github.io/atom.xml"/>
    <subtitle>ä¿®ç‚¼å¤§é­”æ³•å¸ˆ</subtitle>
    <logo>https://chenzdna.github.io/images/avatar.png</logo>
    <icon>https://chenzdna.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, é˜¿å¾DNA</rights>
    <entry>
        <title type="html"><![CDATA[[GoFrame] ä½¿ç”¨ chunked å®ç°å³æ—¶é€šä¿¡è¸©å‘è®°å½•]]></title>
        <id>https://chenzdna.github.io/post/goframe-shi-yong-chunked-shi-xian-ji-shi-tong-xin/</id>
        <link href="https://chenzdna.github.io/post/goframe-shi-yong-chunked-shi-xian-ji-shi-tong-xin/">
        </link>
        <updated>2022-04-26T10:47:54.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å‰ç½®çŸ¥è¯†">å‰ç½®çŸ¥è¯†</h1>
<h2 id="http-å“åº”æ ¼å¼">http å“åº”æ ¼å¼</h2>
<p>ç¬¬ä¸€è¡Œæ˜¯çŠ¶æ€è¡Œï¼Œæ¯”å¦‚è¯´å“åº” 200 å°±æ˜¯</p>
<pre><code>HTTP/1.1 200 OK
</code></pre>
<p>ä¸ç©ºè¡Œï¼Œåé¢æ˜¯å“åº”å¤´</p>
<pre><code>Connection: keep-alive
Transfer-Encoding: chunked
......
</code></pre>
<p>ç©ºä¸€è¡Œï¼Œåé¢æ˜¯å“åº”ä½“ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯-chunked">ä»€ä¹ˆæ˜¯ chunked</h2>
<p>åˆ†å—ä¼ è¾“ <code>Transfer-Encoding: chunked</code> è¡¨ç¤ºè¿™ä¸ªè¯·æ±‚è¿”å›çš„æ•°æ®è¾ƒå¤§ï¼ŒæœåŠ¡ç«¯ä¼šè¾¹ç”Ÿæˆæ•°æ®è¾¹ä¼ è¾“ï¼Œè¿™å°±å¯ä»¥ç”¨æ¥å®ç°æœåŠ¡ç«¯ä¸»åŠ¨ç»™å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯ã€‚</p>
<p>ç¼–ç æ ¼å¼ä¸º</p>
<pre><code>å“åº”è¡Œ
å“åº”å¤´
ï¼ˆç©ºè¡Œï¼‰
å“åº”ä½“
</code></pre>
<p>å…¶ä¸­å“åº”ä½“çš„ç¼–ç æ ¼å¼ä¸º</p>
<pre><code>ï¼ˆå‡è®¾å“åº”æ•°æ®ä¸ºå­—ç¬¦ä¸²sï¼‰
fmt.Sprintf(&quot;%x\r\n&quot;,len(s))
fmt.Sprintf(&quot;%s\r\n&quot;,s)
</code></pre>
<p>æ¯æ®µå“åº”ä½“çš„ç¬¬ä¸€è¡Œæ˜¯å“åº”æ•°æ®æ¯”ç‰¹æµé•¿åº¦çš„ 16 è¿›åˆ¶è¡¨ç¤ºï¼Œç¬¬äºŒè¡Œæ˜¯å“åº”æ•°æ®æœ¬ä½“ã€‚</p>
<h1 id="å¼€æ•´">å¼€æ•´</h1>
<h2 id="vite-å…³é—­è¿æ¥-connection-closed">vite å…³é—­è¿æ¥ <code>Connection: closed</code></h2>
<p>é¡¹ç›®åœ°å€<a href="https://github.com/ChenzDNA/simple_chat_room">åœ¨è¿™é‡Œ</a>ã€‚</p>
<p>åºŸè¯å°‘è¯´ï¼Œæ“ç€ <code>IntelliJ IDEA</code> å°±å¼€å§‹æ’¸ç ã€‚</p>
<p>åç«¯ä½¿ç”¨çš„æ˜¯ <code>GoFrame</code>ï¼Œå…ˆç»™è¯·æ±‚å¤´åŠ ä¸Š <code>Transfer-Encoding: chunked</code>ï¼Œç„¶åæŠŠ <code>Response</code> å¯¹è±¡ä¿å­˜èµ·æ¥ä»¥ä¾¿æœåŠ¡ç«¯ä¸»åŠ¨ç»™å®¢æˆ·ç«¯å‘æ¶ˆæ¯ã€‚</p>
<p>å‰ç«¯ä½¿ç”¨ <code>Vue3+TypeScript</code> å¼€å‘ï¼Œç”¨ <code>vite</code> åšå¼€å‘æœåŠ¡å™¨å¹¶é…å¥½è·¨åŸŸã€‚ç”±äº <code>chunked</code> è¿æ¥åœ¨æ¥å—æ¶ˆæ¯çš„æ—¶å€™ <code>XMLHttpRequest</code>( åç®€ç§°ä¸º <code>xhr</code>) çš„ <code>readyState</code> å±æ€§å¹¶æ²¡æœ‰è·³åˆ° 4ï¼Œè€Œæ˜¯ä¸€ç›´è§¦å‘ 3ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½ç”¨ <code>axios</code> æ¥è¯·æ±‚ï¼Œåªèƒ½è‡ªå·±å°è£…ä¸€ä¸ªã€‚</p>
<p>æ„æƒ³ä¸åˆ°çš„äº‹æƒ…å‘ç”Ÿäº†ï¼Œè¿æ¥è¢«å…³æ‰äº†ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è°å…³çš„è¿æ¥ï¼Ÿæ²¡çœ‹åˆ°å“åº”å¤´æœ‰ <code>chunked</code> å˜›ï¼Ÿåœ¨æµè§ˆå™¨æŸ¥çœ‹å“åº”å¤´çš„ <code>Connection</code> å€¼ä¸º <code>closed</code>ï¼Œè€Œè¯·æ±‚å¤´æ˜¯ <code>Connection: keep-alive</code>ï¼Œ<code>GoFrame</code> æ˜¯ä¸æ˜¯ä½ ï¼Ÿ</p>
<p>æˆ‘äºæ˜¯å¼€å§‹äº†æ¼«é•¿çš„é€® bug ä¹‹æ—…ã€‚ç»è¿‡æ— æ•°æ¬¡åœ¨æºç æ‰“æ–­ç‚¹ã€log ä¿¡æ¯ä¹‹åå¾—å‡ºç»“è®ºï¼š<strong><code>Connection</code> åœ¨è¿›å…¥åç«¯çš„æ—¶å€™å°±å·²ç»ä¸º <code>closed</code></strong>ã€‚éº»äº†ï¼Œå…³è¿æ¥çš„æ—¢ä¸æ˜¯æœåŠ¡ç«¯ä¹Ÿä¸æ˜¯å®¢æˆ·ç«¯ï¼Œè€Œæ˜¯ <code>vite</code>ã€‚</p>
<p>çƒ¦å†…ï¼Œå…ˆç¡è§‰äº†ã€‚</p>
<p>ç¡®å®šæ˜¯ <code>vite</code> åœ¨ä»£ç†çš„æ—¶å€™ä¼šæŠŠè¿æ¥å…³é—­ï¼Œäºæ˜¯ä¸ç”¨ <code>vite</code> åšè·¨åŸŸäº†ï¼Œè®¾ç½® <code>xhr.withCredentials=true</code>ï¼Œè¯è¯´æˆ‘è¿™æ˜¯ç®€å•è¯·æ±‚å•Šï¼Œå‰ç«¯ä¸éœ€è¦åŠ è·¨åŸŸã€‚</p>
<p>å¥½ï¼Œè¿™æ¬¡å“åº”å¤´æœ‰ <code>Connection: keep-alive</code> äº†ã€‚ä¸è¿‡æ–­è¿æ¥çš„é—®é¢˜è¿˜æ˜¯æ²¡æœ‰è§£å†³ã€‚äºæ˜¯åˆå¼€å§‹æ¼«é•¿çš„ç¿» <code>GoFrame</code> æºç ï¼Œè¯•å›¾æ‰¾åˆ° <code>connection.Close()</code> ä¹‹ç±»çš„è››ä¸é©¬è¿¹ã€‚</p>
<p>ç„¶åæ²¡æ‰¾åˆ°ã€‚</p>
<p>äºæ˜¯å¼€å§‹å¿…åº”ã€‚</p>
<h2 id="connection-keep-aliveä½†æ˜¯æœåŠ¡ç«¯å…³é—­è¿æ¥"><code>Connection: keep-alive</code>ï¼Œä½†æ˜¯æœåŠ¡ç«¯å…³é—­è¿æ¥</h2>
<p>æˆ‘çš„å¥½å¿…åº”ï¼Œè®©æˆ‘æ‰¾åˆ°äº†ç”¨ <code>gin</code> å®ç° <code>chunked</code> é€šä¿¡çš„ç¤ºä¾‹ä»£ç ï¼Œæˆ‘åˆå……æ»¡äº†å†³å¿ƒã€‚</p>
<p>ç”¨ <code>gin</code> å®è·µäº†ä¸€ä¸‹ç¡®å®å¯è¡Œï¼Œæ­£å½“æˆ‘æƒ³æ¢æ¡†æ¶çš„æ—¶å€™æˆ‘ä¸€ä¸ªçªå‘å¥‡æƒ³ï¼Œå¼€ä¸€ä¸ªåç¨‹ç»§ç»­å¾€ <code>Response</code> é‡Œå†™æ•°æ®ï¼Œçœ‹å‰ç«¯ä¼šä¸ä¼šå“åº”ã€‚</p>
<p>ç„¶åè¿æ¥åˆåˆè¢«å…³äº†ã€‚åœ¨ handler å‡½æ•°è¿”å›ä¹‹åï¼Œè¿æ¥å°±å…³äº†ã€‚é‚£åº”è¯¥ä¸æ˜¯æ¡†æ¶çš„é—®é¢˜ã€‚äºæ˜¯åˆå¼€å§‹å¿…åº”ã€‚</p>
<p>ç»ˆäºï¼Œåœ¨ github goframe <code>issue</code> é‡Œé¢æ‰¾åˆ°äº† <code>chunked</code> é€šä¿¡çš„ç¤ºä¾‹ä»£ç ï¼ŒåŸæ¥è¦æ‹¿åˆ°åº•å±‚çš„ <code>ResponseWriter</code>ã€‚è¹‚èºäº†ä¸€ç•ªé”®ç›˜ï¼Œå‡ºç°äº†å’Œ <code>gin</code> ä¸€æ ·çš„é—®é¢˜ã€‚æ‰€ä»¥æˆ‘çš„æ–¹å‘é”™äº†ï¼Œé—®é¢˜åº”è¯¥å‡ºåœ¨æ¯”æ¡†æ¶è¿˜è¦åº•å±‚çš„ä¸œè¥¿ã€‚</p>
<p>é‡åˆ°å›°éš¾ç¡å¤§è§‰ã€‚</p>
<h2 id="ä½¿ç”¨-hijack-è§£å†³">ä½¿ç”¨ Hijack è§£å†³</h2>
<p>æ–°ä¸€å¤©ï¼Œä¸Šè¯¾çš„æ—¶å€™æ— èŠçœ‹ go è¯­è¨€æ ‡å‡†åº“æ–‡æ¡£ï¼Œçœ‹åˆ° <code>net/http</code> åº“é‡Œæœ‰ä¸€ä¸ª <code>type Hijacker</code>ï¼Œæˆ‘åˆå……æ»¡äº†å†³å¿ƒã€‚</p>
<p>è¿™ä¸ª <code>Hijack()</code> å‡½æ•°å¥½å‡ æŠŠéš¾ç”¨ï¼Œä¹ŸçœŸè¸é©¬åˆºæ¿€ã€‚ç›´æ¥è®©æ“ä½œè€…æ¥ç®¡è¿æ¥ï¼Œè°ƒç”¨çš„è¿™ä¸ªæ–¹æ³•åæ¡†æ¶å°±ä¸ä¼šå¯¹è¿æ¥è¿›è¡Œæ“ä½œï¼Œå°±è¿è°ƒç”¨æ¡†æ¶å°è£…å¥½çš„ <code>Writer</code> ä¹Ÿç›´æ¥æŠ¥é”™ã€‚</p>
<p>è¡Œå§ï¼Œç°åœ¨çŸ¥é“å¼€å¤´ä¸ºå•¥è¦è®² <code>http</code> å“åº”çš„ç¼–ç æ ¼å¼äº†å§ï¼Œæˆ‘è¿˜å¾—æ‰‹æ“ <code>http</code> å“åº”ã€‚</p>
<p>ç”±äºæ¥ç®¡äº†è¿æ¥ï¼Œè·¨åŸŸä¹Ÿå¾—æ‰‹åŠ¨æ“ï¼š</p>
<pre><code>access-control-allow-credentials: true
access-control-allow-headers: ......
access-control-allow-methods: GET,PUT,POST,DELETE,OPTIONS
access-control-allow-origin: request.Header.Get(&quot;Origin&quot;)
</code></pre>
<p>ç„¶åä¿å­˜ï¼Œè¿™æ¬¡è¿æ¥ä¸ä¼šæ–­äº†ï¼Œé™¤éè°ƒç”¨ <code>connection.Close()</code> æ–¹æ³•ã€‚</p>
<h1 id="ä¸è¶³ä¹‹å¤„">ä¸è¶³ä¹‹å¤„</h1>
<h2 id="å…³äºä½•æ—¶æ–­å¼€è¿æ¥">å…³äºä½•æ—¶æ–­å¼€è¿æ¥</h2>
<p>åªç”¨ <code>GoFrame</code> ä¹Ÿä¸æ˜¯ä¸èƒ½åšï¼Œå°±æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œé¦–å…ˆå¾—å¼€ä¸€ä¸ªè®¡æ—¶çš„åç¨‹ï¼Œ<code>time</code> åº“æœ‰å°è£…å¥½çš„ï¼Œç„¶åç›‘å¬å‰ç«¯çš„å¿ƒè·³ï¼Œå¦‚æœé¢„å®šçš„æ—¶é—´è¿‡åæ²¡æ”¶åˆ°å¿ƒè·³å°±æ–­å¼€è¿æ¥ã€‚é—®é¢˜æ˜¯æœ‰å¤šå°‘ä¸ªè¿æ¥å°±è¦å¼€å¤šå°‘ä¸ªåç¨‹ï¼Œè™½ç„¶åç¨‹çš„æ¶ˆè€—éå¸¸å°‘ï¼Œä½†è¿˜æ˜¯ä¸æƒ³è¿™ä¹ˆåšã€‚</p>
<p>äºæ˜¯å°±æƒ³åˆ°äº† <code>Redis</code>ï¼Œå¯ä»¥ç›‘å¬ <code>Redis</code> çš„é”®è¿‡æœŸäº‹ä»¶æ¥æ–­å¼€å¯¹åº”çš„è¿æ¥ã€‚ç¼ºç‚¹æ˜¯è¿˜è¦é¢å¤–å¼€ä¸€ä¸ª <code>Redis</code>ï¼Œè¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ã€‚äºæ˜¯å°±å·æ‡’åœ¨å‰ç«¯åŠ äº†ä¸€ä¸ªé€€å‡ºçš„æŒ‰é’®æ¥å…³é—­è¿æ¥ã€‚</p>
<h2 id="å…³äºæ€§èƒ½">å…³äºæ€§èƒ½</h2>
<p>æˆ‘ä¹Ÿä¸çŸ¥é“å¦‚ä½•æµ‹è¯• <code>chunked</code> å’Œ <code>websocket</code> çš„æ€§èƒ½ï¼Œå“ªå¤©å†å¿…åº”ä¸€ä¸‹å§ã€‚</p>
<p>2022-04-26</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Java ä½¿ç”¨æšä¸¾ç±»ä¸å•ä¾‹æ¨¡å¼ä¼˜åŒ– if else åˆ†æ”¯]]></title>
        <id>https://chenzdna.github.io/post/java-shi-yong-mei-ju-lei-yu-dan-li-mo-shi-you-hua-ye-wu-luo-ji/</id>
        <link href="https://chenzdna.github.io/post/java-shi-yong-mei-ju-lei-yu-dan-li-mo-shi-you-hua-ye-wu-luo-ji/">
        </link>
        <updated>2022-03-25T12:36:16.000Z</updated>
        <content type="html"><![CDATA[<p>ç”±äºç¢°åˆ°äº†è¿™æ ·çš„éœ€æ±‚ï¼Œæˆ‘åˆæœ‰ç‚¹è®¾è®¡å¼ºè¿«ç—‡ï¼Œæ•…ç ”ç©¶äº†ä¸€ä¸‹ã€‚çµæ„Ÿæ¥è‡ªæˆ‘ä¹‹å‰å†™çš„ä¸€ä¸ªå°å·¥å…· <a href="https://github.com/ChenzDNA/pypadb">pypadb</a>ã€‚å®é™…ä¸Šè¿™ç§æ–¹æ³•åªé€‚ç”¨äºç®€å•åœ°æŸ¥ä¸ªæ•°æ®ç„¶åè¿”å›ç»™å‰ç«¯ï¼Œè¦åšä¿®æ”¹çš„è¯è¿˜æ˜¯éœ€è¦åˆ¤æ–­æŸ¥å‡ºæ¥çš„ç±»å‹å†åšå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</p>
<p>ä¸šåŠ¡éœ€æ±‚ï¼šæ ¹æ®å‰ç«¯ä¼ çš„ä¸€ä¸ªä»£è¡¨æ•°æ®ç§ç±»çš„å­—ç¬¦ä¸²å’Œè‹¥å¹²æŸ¥è¯¢å‚æ•°æ¥æŸ¥è¯¢ä¸åŒè¡¨é‡Œçš„æ•°æ®ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´å¯ä»¥ç”¨ if else åˆ¤æ–­å­—ç¬¦ä¸²æ¥å¤„ç†ï¼Œä½†æ˜¯è¿™æ ·åœ¨è¡¨æ¯”è¾ƒå¤šçš„æ—¶å€™ä¼šé€ æˆ if else è¿‡å¤šï¼Œè€Œä¸” if else é‡Œé¢è¿˜æœ‰å¯èƒ½åµŒå¥—å…¶ä»–çš„ if elseï¼Œçœ‹ç€å°±å¤´å¤§ã€‚æ‰€ä»¥è¿™æ¬¡æ¥ä»‹ç»ä¸€ä¸ªç”¨æšä¸¾ç±»æ¥ä¼˜åŒ– if else åˆ†æ”¯çš„æ–¹æ³•ã€‚</p>
<p>ä½¿ç”¨äº† <a href="https://www.mybatis-plus.com/">Mybatis-Plus</a> å’Œ <a href="https://projectlombok.org/">lombok</a> ç®€åŒ–æ¼”ç¤ºçš„ä»£ç ï¼Œ<code>Spring Boot Starter Test</code> ç”¨æ¥å•å…ƒæµ‹è¯•ã€‚</p>
<h1 id="é¢„è®¾">é¢„è®¾</h1>
<p>å…ˆä¸Šè¡¨ç»“æ„ï¼ˆé¢„å…ˆå¡«äº†ä¸€åˆ—æ•°æ®ï¼‰ï¼š</p>
<pre><code class="language-console">è¡¨ a
+-----+--------+
| id  | data_a |
+-----+--------+
| 123 | aaaaaa |
+-----+--------+

è¡¨ b
+-----+--------+
| id  | data_b |
+-----+--------+
| 123 | bbbbbb |
+-----+--------+
</code></pre>
<p>å®ä½“ç±»ï¼š</p>
<pre><code class="language-java">@Data
@TableName(&quot;a&quot;)
public class AEntity {
    @TableId
    String id;
    String dataA;
}

@Data
@TableName(&quot;b&quot;)
public class BEntity {
    @TableId
    String id;
    String dataB;
}
</code></pre>
<p>ç”±äºåªæ˜¯æ¼”ç¤ºä½œç”¨ï¼Œå°±æ²¡å†™ Service å±‚äº†ã€‚å®é™…å¼€å‘ä¸­å¯ä»¥è®©æ‰€æœ‰ Service æˆ– Dao éƒ½å®ç°æˆ–ç»§æ‰¿ä¸€ä¸ªæ¥å£ï¼Œç„¶åå®ç°æ¥å£é‡Œçš„æŸ¥è¯¢æ–¹æ³•ã€‚</p>
<pre><code class="language-java">@Mapper
public interface ADao extends BaseMapper&lt;AEntity&gt; {
}

@Mapper
public interface BDao extends BaseMapper&lt;BEntity&gt; {
}
</code></pre>
<h1 id="å…³é”®ä»£ç ">å…³é”®ä»£ç </h1>
<p>æšä¸¾ç±»ï¼š</p>
<pre><code class="language-java">public enum TableEnum {
    a(ADao.class),
    b(BDao.class);

    private Class daoClass;

    private volatile BaseMapper dao;

    TableEnum(Class daoClass) {
        this.daoClass = daoClass;
    }

    public BaseMapper getDao() {
        if (dao == null) {
            synchronized (TableEnum.class) {
                if (dao == null) {
                    dao = (BaseMapper) IOCConfig.getBean(daoClass);
                }
            }
        }
        return dao;
    }
}
</code></pre>
<p>ç”¨åˆ°çš„å•ä¾‹æ¨¡å¼åŠ ä¸Šäº†åŒé‡éªŒè¯æ¥é˜²æ­¢å¹¶å‘é—®é¢˜ã€‚</p>
<p>å¯¹åº”çš„å•å…ƒæµ‹è¯•ï¼š</p>
<pre><code class="language-java">@SpringBootTest
class BlogdemosApplicationTests {
    public static String a = &quot;a&quot;;
    public static String b = &quot;b&quot;;
    public static String id = &quot;123&quot;;

    @Test
    void test1() {
        Object o1 = TableEnum.valueOf(a).getDao().selectById(id);
        Object o2 = TableEnum.valueOf(b).getDao().selectById(id);

        System.out.println(&quot;------- o1 -------&quot;);
        System.out.println(JSONObject.toJSONString(o1, true));
        System.out.println(&quot;------- o2 -------&quot;);
        System.out.println(JSONObject.toJSONString(o2, true));

        // è¦ä¿®æ”¹æŸ¥å‡ºæ¥çš„æ•°æ®åªèƒ½åˆ¤æ–­ç±»å‹ç„¶åå¼ºè½¬ã€‚
        if (o1 instanceof AEntity) {
            System.out.println(&quot;o1 instance AEnitty&quot;);
        }
        if (o2 instanceof BEntity) {
            System.out.println(&quot;o2 instance BEnitty&quot;);
        }
    }
}
</code></pre>
<h1 id="ä¸€äº›æ€è€ƒ">ä¸€äº›æ€è€ƒ</h1>
<p>å…³äºæŸ¥å‡ºæ¥çš„æ•°æ®åªèƒ½æ˜¯ <code>Object</code> ç±»å‹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘æƒ³äº†ä¸€ä¸‹ï¼ŒåŒ…æ‹¬ä½¿ç”¨å¸¦æ³›å‹çš„æ™®é€šç±»æ¥æ¨¡æ‹Ÿæšä¸¾ç±»çš„è¡Œä¸ºï¼Œç„¶åæƒ³é€šè¿‡åå°„æ¥è·å– <code>BaseMapper</code> é‡Œå¯¹åº”çš„æ³›å‹ï¼Œè¿”å›æ­£ç¡®çš„ç±»å‹ã€‚ä½†æ˜¯æ²¡æƒ³åˆ°æ€ä¹ˆå†™ã€‚ä»å®è§‚çš„è§’åº¦çœ‹ï¼Œæƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJvm å°±éœ€è¦æ ¹æ®ä¸€ä¸ªä¸çŸ¥é“æ˜¯ä»€ä¹ˆå†…å®¹çš„å­—ç¬¦ä¸²ç¡®å®šä¸€ä¸ªç±»å‹ï¼Œé™æ€ç±»å‹è¯­è¨€çš„ Java å¥½åƒåšä¸åˆ°è¿™ä¸€ç‚¹ã€‚</p>
<h1 id="é™„">é™„</h1>
<p>ä½¿ç”¨ä¸€èˆ¬ç±»æ¥æ¨¡æ‹Ÿæšä¸¾ç±»çš„è¡Œä¸ºï¼š</p>
<pre><code class="language-java">@Slf4j
public class Tables {
    private static Map&lt;String, Class&gt; classMap = new ConcurrentHashMap&lt;&gt;();
    private static Map&lt;String, BaseMapper&gt; daoMap = new ConcurrentHashMap&lt;&gt;();

    private static void initClassMap(Object... args) {
        if (args == null || args.length &lt; 2 || (args.length &amp; 1) == 1) {
            log.error(&quot;Invalid arguments.&quot;);
            return;
        }
        for (int i = 0; i &lt; args.length; i += 2) {
            classMap.put((String) args[i], (Class) args[i + 1]);
        }
    }

    static {
        initClassMap(
                &quot;a&quot;, ADao.class,
                &quot;b&quot;, BDao.class
        );
    }

    public static BaseMapper valueOf(String table) {
        if (!classMap.containsKey(table)) {
            return null;
        }
        BaseMapper dao = daoMap.get(table);
        if (dao == null) {
            dao = (BaseMapper) IOCConfig.getBean(classMap.get(table));
            daoMap.put(table, dao);
        }
        return dao;
    }
}
</code></pre>
<p>ä¸åƒæšä¸¾ç±»ï¼Œä¸€èˆ¬ç±»å¯ä»¥ä¸€æ­¥å°±æ‹¿åˆ°å¯¹åº”çš„ Daoï¼Œåªä¸è¿‡åæœŸæƒ³è¦ä¿®æ”¹æˆ–æ·»åŠ å…¶ä»–çš„è¡¨éœ€è¦æ”¹ static ä»£ç å—é‡Œé¢çš„ä»£ç ï¼Œç›¸æ¯”äºæšä¸¾ç±»æ¥è¯´å°‘äº†ä¸€ç‚¹ä¼˜é›…ã€‚å¹¶å‘é—®é¢˜å°±äº¤ç»™ <code>ConcurrentHashMap</code> æ¥è§£å†³ã€‚</p>
<p>2022-03-25</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è£… Linux ç³»ç»Ÿåè¦åšçš„äº‹]]></title>
        <id>https://chenzdna.github.io/post/zhuang-linux-xi-tong-hou-yao-zuo-de-shi/</id>
        <link href="https://chenzdna.github.io/post/zhuang-linux-xi-tong-hou-yao-zuo-de-shi/">
        </link>
        <updated>2022-02-21T08:29:26.000Z</updated>
        <content type="html"><![CDATA[<p>åœ¨äºŒå¥¶æœºä¸Šæ£é¼“ Linux ç³»ç»Ÿï¼Œæœ‰æ—¶å€™åˆ äº†ç³»ç»Ÿæ–‡ä»¶ï¼Œé‡è£…äº†å‡ æ¬¡ç³»ç»Ÿã€‚ä¸ºäº†ä»¥åé‡è£…ç³»ç»Ÿé…ä¸œè¥¿ä¸å†ä¸œæ‰¾è¥¿æ‰¾ï¼Œå°±å†™äº†è¿™ä¸€ç¯‡æ€»ç»“ä¸€ä¸‹ï¼Œ<strong>ä»…ä¾›å‚è€ƒ</strong>ã€‚</p>
<h1 id="ssh-å…è®¸-root-ç”¨æˆ·è¿œç¨‹ç™»å½•">SSH å…è®¸ root ç”¨æˆ·è¿œç¨‹ç™»å½•</h1>
<p>ä¸€èˆ¬æ¥è¯´æ˜¯ä¸å»ºè®® root ç”¨æˆ·ç™»å½• SSHï¼Œä½†æ˜¯æˆ‘åˆæ²¡å…¬ç½‘ ipï¼Œå°±è¿™æ ·äº†ã€‚</p>
<p>ç¼–è¾‘ sshd çš„é…ç½®æ–‡ä»¶ï¼š</p>
<p><code>vim /etc/ssh/sshd_config</code></p>
<p>æ‰¾åˆ° <code>PermitRootLogin</code>ï¼Œè®¾ä¸º <code>yes</code>ï¼Œè®°å¾—å»æ‰æ³¨é‡Šã€‚</p>
<p>é‡å¯ sshï¼Œæˆ–è€…é‡å¯ç”µè„‘ï¼š</p>
<p><code>service sshd restart</code></p>
<h1 id="è®¾ç½®ç¬”è®°æœ¬åˆç›–ä¸ç¡çœ ">è®¾ç½®ç¬”è®°æœ¬åˆç›–ä¸ç¡çœ </h1>
<p>ç¼–è¾‘ <code>logind.conf</code>ï¼š</p>
<p><code>vim /etc/systemd/logind.conf</code></p>
<p>æ‰¾åˆ° <code>HandleLidSwitch</code>ï¼Œæ”¹ä¸º <code>ignore</code>ï¼Œè®°å¾—å»æ‰æ³¨é‡Šã€‚</p>
<p>é‡å¯æœåŠ¡ï¼Œæˆ–é‡å¯ç”µè„‘ï¼š</p>
<p><code>systemctl restart systemd-logind</code></p>
<h1 id="ç³»ç»Ÿå·¥å…·å®‰è£…">ç³»ç»Ÿå·¥å…·å®‰è£…</h1>
<pre><code class="language-bash">apt install -y lsof vim gcc default-jdk redis nginx mariadb nodejs ffmpeg
</code></pre>
<h1 id="python-ä¾èµ–">Python ä¾èµ–</h1>
<pre><code class="language-bash">python3 -m pip install BeautifulSoup4 fastapi requests nb-cli pydantic nonebot2
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spring Boot ç›‘å¬ Redis çš„é”®è¿‡æœŸäº‹ä»¶]]></title>
        <id>https://chenzdna.github.io/post/spring-boot-jian-ting-redis-de-jian-guo-qi-shi-jian/</id>
        <link href="https://chenzdna.github.io/post/spring-boot-jian-ting-redis-de-jian-guo-qi-shi-jian/">
        </link>
        <updated>2022-02-21T07:35:42.000Z</updated>
        <content type="html"><![CDATA[<h1 id="redis-é…ç½®">Redis é…ç½®</h1>
<h2 id="æ–¹æ³•ä¸€-æ›´æ”¹é…ç½®æ–‡ä»¶ä»¥é…ç½®æ–‡ä»¶å¯åŠ¨">æ–¹æ³•ä¸€ã€æ›´æ”¹é…ç½®æ–‡ä»¶ï¼Œä»¥é…ç½®æ–‡ä»¶å¯åŠ¨</h2>
<p>è¿›å…¥ Redis å®‰è£…ç›®å½•ï¼Œä¿®æ”¹ <code>redis.windows.conf</code> (Linux ä¸‹é…ç½®æ–‡ä»¶æ˜¯ <code>redis.conf</code>)</p>
<p>åœ¨ç¬¬892è¡Œæ‰¾åˆ° <code>notify-keyspace-events</code> (Windows ç³»ç»Ÿï¼ŒRedis ç‰ˆæœ¬ 5.0.10)</p>
<p><code>notify-keyspace-events &quot;&quot;</code></p>
<p>ä¸Šé¢æœ‰é…ç½®é¡¹çš„æ³¨é‡Š</p>
<pre><code>K     Keyspace events, published with __keyspace@&lt;db&gt;__ prefix.
E     Keyevent events, published with __keyevent@&lt;db&gt;__ prefix.
g     Generic commands (non-type specific) like DEL, EXPIRE, RENAME, ...
$     String commands
l     List commands
s     Set commands
h     Hash commands
z     Sorted set commands
x     Expired events (events generated every time a key expires)
e     Evicted events (events generated when a key is evicted for maxmemory)
A     Alias for g$lshzxe, so that the &quot;AKE&quot; string means all the events.
</code></pre>
<p>é…ç½®æ­¤é¡¹ä¸ºé”®äº‹ä»¶è¿‡æœŸé€šçŸ¥</p>
<p><code>notify-keyspace-events Ex</code></p>
<p>ä»¥é…ç½®æ–‡ä»¶å¯åŠ¨</p>
<p><code>redis-server redis.windows.conf</code></p>
<h2 id="æ–¹æ³•äºŒ-åœ¨-redis-cli-ä¸­é…ç½®">æ–¹æ³•äºŒã€åœ¨ redis-cli ä¸­é…ç½®</h2>
<p>è¿è¡Œ <code>redis-cli</code>ï¼Œè¿è¡Œå‘½ä»¤</p>
<p><code>config set notify-keyspace-events Ex</code></p>
<p>æˆ–åœ¨ç»ˆç«¯ç›´æ¥è¿è¡Œå‘½ä»¤</p>
<p><code>redis-cli config set notify-keyspace-events Ex</code></p>
<h1 id="spring-boot-ç›‘å¬">Spring Boot ç›‘å¬</h1>
<h2 id="å¼•å…¥ä¾èµ–">å¼•å…¥ä¾èµ–</h2>
<pre><code class="language-xml">&lt;!-- maven --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<pre><code class="language-json">// gradle
compile(&quot;org.springframework.boot:spring-boot-starter-data-redis&quot;)
</code></pre>
<h2 id="redismessagelistenerjava">RedisMessageListener.java</h2>
<pre><code class="language-java">@Component
public class RedisMessageListener implements MessageListener {
    @Resource
    private RedisTemplate&lt;String, Object&gt; redis;

    @Override
    public void onMessage(Message message, byte[] pattern) {
        System.out.println(&quot;----------- &quot; + new String(pattern));
        // ä½¿ç”¨äº† fastjson æ¥æ‰“å°å¯¹è±¡
        System.out.println(JSONObject.toJSONString(message, true));
        System.out.println(&quot;-------------------------------&quot;);
        // è·å–è¿‡æœŸçš„é”®
        System.out.println(redis.getValueSerializer().deserialize(message.getBody()));
    }
}
</code></pre>
<h2 id="redisconfigjava">RedisConfig.java</h2>
<pre><code class="language-java">@Configuration
public class RedisConfig {
    @Resource
    private RedisMessageListener messageListener;

    @Bean
    public RedisTemplate&lt;String, Object&gt; redisTemplate(RedisConnectionFactory redisConnectionFactory) {
        RedisTemplate&lt;String, Object&gt; template = new RedisTemplate&lt;&gt;();
        template.setConnectionFactory(redisConnectionFactory);

        template.setKeySerializer(new StringRedisSerializer());
        final Jackson2JsonRedisSerializer&lt;Object&gt; serializer = new Jackson2JsonRedisSerializer&lt;&gt;(Object.class);
        template.setValueSerializer(serializer);

        return template;
    }

    @Bean
    public ChannelTopic channelTopic() {
        // ç›‘å¬ Redis é”®è¿‡æœŸäº‹ä»¶é€šçŸ¥
        return new ChannelTopic(&quot;__keyevent@0__:expired&quot;);
    }

    @Bean
    public RedisMessageListenerContainer redisMessageListenerContainer(RedisConnectionFactory redisConnectionFactory) {
        RedisMessageListenerContainer redisMessageListenerContainer = new RedisMessageListenerContainer();
        redisMessageListenerContainer.setConnectionFactory(redisConnectionFactory);
        redisMessageListenerContainer.addMessageListener(messageListener, channelTopic());
        return redisMessageListenerContainer;
    }
}
</code></pre>
<h1 id="è¿è¡Œæµ‹è¯•">è¿è¡Œæµ‹è¯•</h1>
<h2 id="æ–¹æ³•1-åœ¨-redis-cli-ä¸­æ“ä½œ">æ–¹æ³•1ã€åœ¨ redis-cli ä¸­æ“ä½œ</h2>
<p><code>set 123 456 PX 100</code></p>
<p>é”® 123ï¼Œå€¼ 456ï¼Œ100ms åè¿‡æœŸï¼Œè‹¥ <code>PX</code> è®¾ä¸º <code>EX</code> åˆ™æ—¶é—´å•ä½ä¸ºç§’ã€‚</p>
<h2 id="æ–¹æ³•2-ä½¿ç”¨-spring-boot-æ“ä½œ">æ–¹æ³•2ã€ä½¿ç”¨ Spring Boot æ“ä½œ</h2>
<pre><code class="language-java">
@RestController
public class TestController {
    @Resource
    private RedisTemplate&lt;String, Object&gt; redis;

    @GetMapping(&quot;/redis&quot;)
    public void re() {
        ValueOperations&lt;String, Object&gt; ops = redis.opsForValue();
        ops.set(&quot;123&quot;, &quot;456&quot;);
        // è®¾ç½®éœ€è¦è¿‡æœŸçš„é”®ï¼Œè¿‡æœŸæ—¶é—´ï¼Œæ—¶é—´å•ä½
        redis.expire(&quot;123&quot;, 100L, TimeUnit.MILLISECONDS);
    }
}
</code></pre>
<h2 id="è¿è¡Œç»“æœ">è¿è¡Œç»“æœ</h2>
<p>æ§åˆ¶å°æ‰“å°</p>
<pre><code>----------- __keyevent@0__:expired
{
	&quot;body&quot;:&quot;MTIz&quot;,
	&quot;channel&quot;:&quot;X19rZXlldmVudEAwX186ZXhwaXJlZA==&quot;
}
-------------------------------
123
</code></pre>
<p>æˆåŠŸæ‹¿åˆ°è¿‡æœŸçš„é”® 123ã€‚</p>
<h1 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h1>
<p>Spring Boot 2.6 é»˜è®¤ç¦æ­¢äº†å¾ªç¯å¼•ç”¨ï¼Œéœ€è¦é…ç½®å¼€å¯å¾ªç¯å¼•ç”¨ã€‚</p>
<pre><code class="language-yaml">spring:
  main:
    allow-circular-references: true
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[pypadb ä½¿ç”¨æ–‡æ¡£ #5ã€ä½¿ç”¨æ¨¡å—å¯¼å…¥åˆå§‹åŒ– tables]]></title>
        <id>https://chenzdna.github.io/post/pypadb-shi-yong-wen-dang-5shi-yong-mo-kuai-dao-ru-chu-shi-hua-tables/</id>
        <link href="https://chenzdna.github.io/post/pypadb-shi-yong-wen-dang-5shi-yong-mo-kuai-dao-ru-chu-shi-hua-tables/">
        </link>
        <updated>2022-02-04T15:41:27.000Z</updated>
        <content type="html"><![CDATA[<p>è¿™ä¸ªç®—æ›´æ–°çš„å†…å®¹ï¼Œæ‰€ä»¥å°±æ²¡æ”¹ä»¥å‰å†™çš„åˆå§‹åŒ– tables äº†ã€‚</p>
<p>ä½¿ç”¨ä¹‹å‰çš„ä¾‹å­ï¼š</p>
<pre><code class="language-python">from typing import Optional as _Optional

from pydantic import BaseModel as _BaseModel


class Stuff(_BaseModel):
    test_id: int
    name: str
    count: int


class Test(_BaseModel):
    id: _Optional[int]
    content: str
    stuffs: _Optional[list[StuffWuhu]]
    ctime: _Optional[int]
    mtime: _Optional[int]
</code></pre>
<p>æŠŠè¿™ä¸¤ä¸ªç±»å†™åˆ°ä¸€ä¸ªæ¨¡å—é‡Œé¢ï¼Œæ³¨æ„ <code>import</code> å¯¼åŒ…è¦è½¬ä¸ºä¸‹åˆ’çº¿å¼€å¤´çš„åŒ…åï¼Œä»¥å… pypadb è¯†åˆ«é”™è¯¯ã€‚</p>
<pre><code class="language-python">from pypadb.conf.table_configurer import tables

# é‚£ä¸¤ä¸ªç±»æ‰€åœ¨çš„åŒ…
import entities

if __name__ == '__main__':
    # åˆå§‹åŒ–tables
    tables.init_tables(entities)
    # tables.test
    # tables.stuff
    print(tables.tables)
</code></pre>
<p>è¿™ç§åˆå§‹åŒ–ä¼šæŠŠé©¼å³°å‘½åçš„ç±»åè½¬æˆä¸‹åˆ’çº¿æ¥ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥è®¾ç½®å‚æ•° <code>escape_upper=True</code> ä¸å¤„ç†é©¼å³°å‘½åã€‚</p>
<p>2022-02-04</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[pypadb ä½¿ç”¨æ–‡æ¡£ #4ã€ä½¿ç”¨ tables æŸ¥è¯¢]]></title>
        <id>https://chenzdna.github.io/post/pypadb-shi-yong-wen-dang-4shi-yong/</id>
        <link href="https://chenzdna.github.io/post/pypadb-shi-yong-wen-dang-4shi-yong/">
        </link>
        <updated>2022-01-30T12:14:20.000Z</updated>
        <content type="html"><![CDATA[<p>æŸ¥è¯¢æƒ³å¯¹æ¥è¯´æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦ä¸€äº›ç±»æ¥è¾…åŠ©ã€‚</p>
<p>é¦–å…ˆæœ‰ä¸‰ä¸ªæ–¹æ³•ï¼š</p>
<pre><code class="language-python">def select_one(self, extra=None, **kwargs):
    pass

def select_many(self, limit: Limit = None, extra=None, **kwargs) -&gt; list:
    pass

def select_like(self,
                likes: Union[list[Like], Like] = {},
                limit: Limit = None,
                extra=None) -&gt; list:
    pass
</code></pre>
<ul>
<li><code>select_one</code> æŸ¥è¯¢å•ä¸ªå¯¹è±¡ã€‚</li>
<li><code>select_many</code> æŸ¥è¯¢å¤šä¸ªå¯¹è±¡ï¼ŒæŠŠç»“æœé›†ä¸­çš„å†…å®¹ä»¥ <code>list</code> çš„å½¢å¼è¿”å›ã€‚</li>
<li><code>select_like</code> æ¨¡ç³ŠæŸ¥è¯¢ï¼Œæ€»æ˜¯ä»¥ <code>list</code> çš„å½¢å¼è¿”å›ã€‚</li>
</ul>
<p>ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œåœ¨ <a href="/post/pypadb-shi-yong-wen-dang-2">pypadb ä½¿ç”¨æ–‡æ¡£ #2</a> çš„è¡¨å’Œå®ä½“ç±»çš„åŸºç¡€ä¸Šæ–°å¢å¦‚ä¸‹è¡¨å’Œå®ä½“ç±»ï¼š</p>
<pre><code class="language-sql">create table stuff
(
    test_id bigint       not null,
    name    varchar(20)  null,
    count   int unsigned null
);
</code></pre>
<pre><code class="language-python"># æ–°å¢ Stuff ç±»å¯¹åº” stuff è¡¨
class Stuff(BaseModel):
    test_id: int
    name: str
    count: int

# ä¿®æ”¹ Testï¼Œæ–°å¢ stuffs å±æ€§
class Test(BaseModel):
    id: Optional[int]
    content: str
    stuffs: Optional[list[Stuff]]
    ctime: Optional[int]
    mtime: Optional[int]
</code></pre>
<p><code>test</code> è¡¨é‡Œçš„ <code>id</code> å±æ€§å¯¹åº” <code>stuff</code> è¡¨é‡Œçš„ <code>test_id</code>ï¼Œåœ¨æŸ¥è¯¢ <code>test</code> è¡¨æ—¶åº”è¯¥æŠŠå¯¹åº”çš„ <code>Stuff</code> å¯¹è±¡éƒ½æŸ¥å‡ºæ¥ã€‚</p>
<h1 id="åˆå§‹åŒ–">åˆå§‹åŒ–</h1>
<pre><code class="language-python">from pypadb.conf.table_configurer import tables

tables.init_tables(stuff=Stuff, test=Test)
</code></pre>
<h1 id="select_one">select_one</h1>
<pre><code class="language-python"># ä¸å¸¦ä»»ä½•å‚æ•°ï¼Œè¿”å›è¡¨ä¸­çš„ç¬¬ä¸€æ¡æ•°æ®ï¼ˆåº”è¯¥æ²¡äººç”¨è¿™ä¸ªï¼‰
tables.test.select_one()

# ä½¿ç”¨ extra
from pypadb.utils.conditions import extra

tables.test.select_one(
    id=1,
    extra=extra(column=['id', 'test_id'],
                data_property='stuffs',
                method=tables.stuff.select_many)
)

# ä¼ å…¥æŸ¥è¯¢æ¡ä»¶
tables.tset.select_one(id=1)
</code></pre>
<p>å‚æ•° <code>extra</code> æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒæ¥å— <code>pypadb.utils.conditions.extra</code> å‡½æ•°è¿”å›çš„å€¼å¹¶è¿›è¡Œå¯¹åº”çš„å¤„ç†ã€‚</p>
<p><code>pypadb.utils.conditions.extra</code> å‡½æ•°æ¥å—ä¸‰ä¸ªå‚æ•° <code>column</code>ã€<code>data_property</code>ã€<code>method</code>ã€‚</p>
<ul>
<li><code>column</code>ï¼šä¸€ä¸ªé•¿åº¦ä¸º 2 çš„æ•°ç»„ï¼Œå€¼ä¸º [å½“å‰è°ƒç”¨è¡¨çš„åˆ—å, éœ€è¦é¢å¤–æŸ¥è¯¢çš„è¡¨çš„åˆ—å]ã€‚å½“å‰è¡¨å’Œé¢å¤–è¡¨æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚</li>
<li><code>data_property</code>ï¼šéœ€è¦å¡«å……çš„å±æ€§åã€‚</li>
<li><code>method</code>ï¼šæŸ¥è¯¢çš„æ–¹æ³•ã€‚</li>
</ul>
<p><code>select_one</code> åœ¨å¤„ç† <code>extra</code> çš„æ—¶å€™ä¼šè°ƒç”¨æŸ¥è¯¢çš„æ–¹æ³•ï¼Œè‡ªåŠ¨å¡«å……å½“å‰è¡¨æŸ¥è¯¢å‡ºæ¥çš„å±æ€§ã€‚</p>
<p>å¦‚ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼ŒæŠŠæ‰€æœ‰ <code>stuff</code> è¡¨é‡Œ <code>test_id</code> ä¸º 1 çš„æ•°æ®å…¨æŸ¥å‡ºæ¥å¡«å……åˆ°ç»“æœé‡Œçš„ <code>stuffs</code> å±æ€§é‡Œã€‚</p>
<h1 id="select_many">select_many</h1>
<pre><code class="language-python">from pypadb.utils.conditions import Limit

tables.test.select_many(limit=Limit(0, 1))
</code></pre>
<p><code>select_many</code> åªæ˜¯æ¯” <code>select_one</code> å¤šä¸€ä¸ªå¯é€‰å‚æ•° <code>limit</code>ã€‚</p>
<p>é¡¾åæ€ä¹‰ï¼Œ<code>limit</code> æ˜¯ç”¨æ¥åšæŸ¥è¯¢åˆ†é¡µçš„ï¼Œ<code>Limit(start, count)</code> ä¼šè§£ææˆ <code>limit %(start)s, %(count)s</code>ï¼Œå…¶ä¸­ <code>count</code> ä¸ºå¯é€‰å‚æ•°ï¼Œè‹¥ä¸ä¼  <code>count</code> åˆ™ä¼šè§£ææˆ <code>limit %(start)s</code></p>
<h1 id="select_like">select_like</h1>
<pre><code class="language-python">from pypadb.utils.conditions import Like
from pypadb.utils.enums import LikeEnum

tables.test.select_like(likes=Like('content', '1', LikeEnum.ALL_Like))
</code></pre>
<p><code>select_like</code> ç›¸æ¯” <code>select_many</code>ï¼Œå¤šäº†ä¸€ä¸ªå‚æ•° <code>likes</code>ï¼Œæ¥å—çš„å€¼å¯ä»¥ä¸º <code>Like</code> æˆ– <code>list[Like]</code>ã€‚è‹¥ä»¥ <code>list[Like]</code> çš„å½¢å¼ä¼ å‚ï¼Œåˆ™æ¨¡ç³ŠæŸ¥è¯¢ä¹‹é—´ä»¥ <code>or</code> ç›¸è¿ï¼Œå³æ‰€æœ‰çš„æ¨¡ç³ŠåŒ¹é…éƒ½ä¼šç”Ÿæ•ˆã€‚</p>
<p><code>Like(column, value, like_type)</code> éœ€è¦æŒ‡å®šæ¨¡ç³ŠæŸ¥è¯¢çš„åˆ—åï¼Œå¹¶ä¼ ä¸€ä¸ªæ¨¡ç³ŠæŸ¥è¯¢çš„å€¼ã€‚ä¼šæ ¹æ® <code>like_type</code> æ¥è§£æå·¦å³æ¨¡ç³ŠåŒ¹é…æˆ–è€…å…¨æ¨¡ç³ŠåŒ¹é…ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[pypadb ä½¿ç”¨æ–‡æ¡£ #3ã€åˆå§‹åŒ– tables && ä½¿ç”¨ tables å¢åˆ æ”¹]]></title>
        <id>https://chenzdna.github.io/post/pypadb-shi-yong-wen-dang-3chu-shi-hua-tables/</id>
        <link href="https://chenzdna.github.io/post/pypadb-shi-yong-wen-dang-3chu-shi-hua-tables/">
        </link>
        <updated>2022-01-30T10:19:22.000Z</updated>
        <content type="html"><![CDATA[<p>æ²¿ç”¨ <a href="/post/pypadb-shi-yong-wen-dang-2">pypadb ä½¿ç”¨æ–‡æ¡£ #2</a> çš„è¡¨å’Œå®ä½“ç±»ï¼Œè¿™ä¸€ç¯‡å°†ä¼šä½¿ç”¨ <code>pypadb.conf.table_configurer.tables</code> æ¥è¿›è¡Œå®ä½“ç±»å’Œè¡¨çš„æ˜ å°„ï¼Œæå¤§çš„å¢åŠ ç¼–å†™ CURD çš„æ•ˆç‡ã€‚</p>
<h1 id="åˆå§‹åŒ–">åˆå§‹åŒ–</h1>
<pre><code class="language-python">from pypadb.conf.table_configurer import tables

tables.init_tables(test=Test)
</code></pre>
<p><code>init_tables</code> ä»¥ <strong>è¡¨å=ç±»</strong> çš„å½¢å¼æ¥å—ä¸€äº› <code>kwargs</code>ï¼Œå¯ä»¥å¤šæ¬¡è°ƒç”¨ï¼Œé‡å¤çš„å€¼ä¼šè¦†ç›–ã€‚</p>
<p>åœ¨è°ƒç”¨åå¯ä»¥ç”¨ <code>tables.test</code> æˆ–è€… <code>tables['test']</code> çš„å½¢å¼æ“ä½œæ•°æ®è¡¨ã€‚</p>
<h1 id="insert">insert</h1>
<pre><code class="language-python"># å•ä¸ªæ’å…¥
tables.test.insert(Test(content='123'))
# æ‰¹é‡æ’å…¥
tables.test.insert([Test(content='111'), Test(content='222')])
</code></pre>
<p><code>insert</code> æ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°ä½œä¸ºæ’å…¥çš„å®ä½“å¯¹è±¡ï¼Œå¯ä»¥ä¸ºä¸€ä¸ªå¯¹è±¡æˆ–è€… <code>list</code>ã€‚è¿”å›æ’å…¥åçš„ä¸»é”®ã€‚ä¸º <code>list</code> æ—¶è¿”å›å€¼ä¸ºæœ€åæ’å…¥çš„ä¸»é”®ã€‚</p>
<h1 id="update">update</h1>
<pre><code class="language-python"># æ›´æ–° id ä¸º 1 çš„æ•°æ®
tables.test.update(Test(content='333'), id=1)
</code></pre>
<p><code>update</code> æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä¿®æ”¹çš„å®ä½“å¯¹è±¡ï¼Œåé¢è¿˜æœ‰è‹¥å¹² kwargs ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢æ¡ä»¶ä¸ºç©ºæ—¶ <code>update</code> æ–¹æ³•ä¸ä¼šä¿®æ”¹ä»»ä½•å€¼ã€‚</p>
<h1 id="delete">delete</h1>
<pre><code class="language-python"># åˆ é™¤ id ä¸º 1 çš„æ•°æ®
tables.test.delete(id=1)
</code></pre>
<p>å’Œ <code>update</code> æ–¹æ³•ç›¸åŒï¼Œkwargs ä¸ºç©ºæ—¶ <code>delete</code> æ–¹æ³•ä¸ä¼šè¿›è¡Œä»»ä½•æ“ä½œã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[pypadb ä½¿ç”¨æ–‡æ¡£ #2ã€ä½¿ç”¨è£…é¥°å™¨è¿›è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œ]]></title>
        <id>https://chenzdna.github.io/post/pypadb-shi-yong-wen-dang-2/</id>
        <link href="https://chenzdna.github.io/post/pypadb-shi-yong-wen-dang-2/">
        </link>
        <updated>2022-01-29T07:35:35.000Z</updated>
        <content type="html"><![CDATA[<p>pypadb æä¾›äº† <code>@insert</code>ã€<code>@update</code>ã€<code>@delete</code>ã€<code>@select</code> å››ä¸ªè£…é¥°å™¨æ¥æ‰©å±•å‡½æ•°ã€‚</p>
<p>æœ‰å¦‚ä¸‹è¡¨ç»“æ„ï¼š</p>
<pre><code class="language-sql">create table test
(
    id      int unsigned auto_increment primary key,
    content varchar(255) null,
    ctime   bigint       null,
    mtime   bigint       null
);
</code></pre>
<p>å®ä½“ç±»å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">class Test(BaseModel):
    id: Optional[int]
    content: str
    ctime: Optional[int]
    mtime: Optional[int]
</code></pre>
<ul>
<li>å®ä½“ç±»é¡»ç»§æ‰¿ <code>pydantic.BaseModel</code>ã€‚</li>
<li>å®ä½“ç±»çš„å±æ€§é¡»æ·»åŠ ç±»å‹æ³¨é‡Šã€‚</li>
<li>å¯ä»¥ä¸º <code>None</code> çš„å±æ€§æˆ–- ä¸åœ¨æ•°æ®åº“è¡¨é‡Œçš„å±æ€§é¡»ç”¨ <code>Optional</code> åŒ…è£¹ã€‚</li>
</ul>
<h1 id="insert">@insert</h1>
<pre><code class="language-python">from pypadb.decorator import insert

@insert('insert into test(content,ctime)')
def ins_test(test: Union[list[Test], Test]):
    # åœ¨ insert å‰ä¿®æ”¹ ctimeï¼ˆåˆ›å»ºæ—¶é—´ï¼‰ä¸ºå½“å‰æ—¶é—´
    test.ctime = int(datetime.datetime.now().timestamp() * 1000)

# å•ä¸ªæ’å…¥
ins_test(Test(content='wow'))
# æ‰¹é‡æ’å…¥
ins_test([Test(content='wow'), Test(content='123456')])
</code></pre>
<p><code>@insert</code> è£…é¥°å™¨æ¥å—ä¸€ä¸ªå‚æ•° <code>sql: str</code>ï¼Œè¦è¡¨æ˜æ’å…¥æ—¶çš„åˆ—åã€‚</p>
<p>è¢«è£…é¥°çš„å‡½æ•°åªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥ä¸º <code>Test</code> æˆ–è€… <code>list[Test]</code>ï¼Œè£…é¥°å™¨åœ¨å¤„ç†çš„æ—¶å€™ä¼šåˆ¤æ–­æ˜¯å¦è¿›è¡Œæ‰¹é‡æ’å…¥ã€‚</p>
<p>å‡½æ•°ä½“å¯ä»¥ä¸º <code>pass</code>ï¼Œå¦‚æœå‡½æ•°ä½“ä¸ä¸ºç©ºï¼Œåˆ™ä¼šåœ¨æ’å…¥å‰è°ƒç”¨å‡½æ•°ï¼Œä¾‹å¦‚ä¸Šé¢çš„ä»£ç ï¼Œåœ¨æ’å…¥å‰åˆå§‹åŒ– <code>ctime</code> å­—æ®µä¸ºå½“å‰æ—¶é—´ã€‚å¯¹äº <code>list[Test]</code>ï¼Œè£…é¥°å™¨åŒæ ·ä¼šåœ¨æ’å…¥å‰å¯¹æ¯ä¸€ä¸ªå®ä½“ç±»è¿›è¡Œå¤„ç†ã€‚</p>
<p>å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¿®æ”¹çš„æœ€åä¸€è¡Œä¸»é”®å€¼ã€‚</p>
<h1 id="update">@update</h1>
<pre><code class="language-python">from pypadb.decorator import update

@update('update test')
def upd_test(test: Test):
    # åœ¨ update å‰ä¿®æ”¹ mtime ï¼ˆä¿®æ”¹æ—¶é—´ï¼‰ä¸ºå½“å‰æ—¶é—´
    test.mtime = int(datetime.datetime.now().timestamp() * 1000)

# å®ä½“ç±»ï¼ŒæŸ¥è¯¢æ¡ä»¶1ï¼ŒæŸ¥è¯¢æ¡ä»¶2 ...
upd_test(Test(content='wuhu'), id=1)
</code></pre>
<p><code>@update</code> æ¥å—ä¸€ä¸ªå‚æ•° <code>sql: str</code>ï¼Œåªéœ€è¦å†™ä¸Šéœ€è¦æ›´æ–°çš„è¡¨ï¼Œè£…é¥°å™¨ä¼šæ ¹æ®ä¼ è¿›æ¥çš„å®ä½“å¯¹è±¡åŠ¨æ€ç”Ÿæˆ sql è¯­å¥ã€‚å³å®ä½“å¯¹è±¡çš„å±æ€§å€¼ä¸º <code>None</code>ã€ç©ºæ•°ç»„æˆ–è€…ç©ºå­—ç¬¦ä¸²æ—¶ï¼Œ<code>@update</code> ä¼šå¿½ç•¥è¿™ä¸€å±æ€§ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè‹¥å±æ€§å€¼ä¸º 0 æ—¶ï¼Œ<code>@update</code> ä¹Ÿä¼šè¿›è¡Œæ›´æ–°ã€‚</p>
<p>å‡½æ•°ä½“å¯ä»¥ä¸º <code>pass</code>ï¼Œå¦‚æœå‡½æ•°ä½“ä¸ä¸ºç©ºï¼Œåˆ™ä¼šåœ¨æ’å…¥å‰è°ƒç”¨å‡½æ•°ï¼Œä¾‹å¦‚ä¸Šé¢çš„ä»£ç ï¼Œåœ¨æ’å…¥å‰åˆå§‹åŒ– <code>mtime</code> å­—æ®µä¸ºå½“å‰æ—¶é—´ã€‚å¯¹äº <code>list[Test]</code>ï¼Œè£…é¥°å™¨åŒæ ·ä¼šåœ¨æ’å…¥å‰å¯¹æ¯ä¸€ä¸ªå®ä½“ç±»è¿›è¡Œå¤„ç†ã€‚</p>
<p>è¢«è£…é¥°çš„å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°ä½œä¸ºå®ä½“å¯¹è±¡ï¼Œè¿˜æœ‰è‹¥å¹²æŒ‡å®šå‚æ•°ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ã€‚</p>
<p>å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¿®æ”¹æ—¶çš„ä¸»é”®å€¼ã€‚</p>
<h1 id="delete">@delete</h1>
<pre><code class="language-python">from pypadb.decorator import delete

@delete('delete from test where id=%(id)s')
def del_test(id: int = 0):
    pass
</code></pre>
<p><code>@delete</code> è£…é¥°å™¨æ¥å—ä¸€ä¸ªå€¼ <code>sql: str</code>ï¼Œè¦å†™å…¨ã€‚è£…é¥°å™¨ä¼šæŠŠå‡½æ•°çš„å‚æ•°åˆ—è¡¨å’Œè°ƒç”¨å‡½æ•°ä¼ è¿›æ¥çš„å€¼åšåŒ¹é…ï¼Œå¤„ç†æˆä¸€ä¸ª <code>dict</code> äº¤ç»™ <code>pymysql</code> å¤„ç†ã€‚</p>
<p><code>@delete</code> åŒæ ·æ”¯æŒåœ¨åˆ é™¤å‰è°ƒç”¨è¢«è£…é¥°çš„å‡½æ•°ã€‚</p>
<h1 id="select">@select</h1>
<pre><code class="language-python">from pypadb.decorator import select

# æŸ¥è¯¢è¿”å›å•ä¸ªå¯¹è±¡
@select('select * from test where id=%(id)s', data_type=Test)
def sel_test_one(id: int) -&gt; Test:
    pass

# æŸ¥è¯¢è¿”å›æ•°ç»„
@select(
    'select * from test where content  like concat(\'%%\',%(concat)s,\'%%\')',
    data_type=Test
)
def sel_test_many(concat: str) -&gt; list[Test]:
    pass
</code></pre>
<p><code>@select</code> è£…é¥°å™¨æ¥å— 2 ä¸ªå‚æ•°ï¼Œå¤„ç† sql è¯­å¥å’Œ <code>@delete</code> ä¸€æ ·ï¼Œç¬¬äºŒä¸ªå‚æ•° <code>data_type</code> æ˜¯ä¸ºäº†å°†æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®åŒ…è£…æˆå¯¹è±¡ã€‚</p>
<p><code>@select</code> è£…é¥°å™¨ä¼šé€šè¿‡åå°„çš„æ–¹å¼æ‹¿åˆ°å‡½æ•°è¿”å›å€¼çš„ç±»å‹æ³¨é‡Šï¼Œåˆ¤æ–­å…¶æ˜¯å¦ä¸º <code>list</code> æ¥å†³å®šè¿”å›å€¼æ˜¯å¦ä¸º <code>list</code>ã€‚è‹¥æŸ¥è¯¢ç»“æœæœ‰å¤šä¸ªï¼Œå‡½æ•°çš„è¿”å›å€¼ç±»å‹æ³¨é‡Šä¸æ˜¯ <code>list</code> çš„è¯ï¼Œè£…é¥°å™¨åªä¼šå–ç»“æœé›†ä¸­çš„é¦–è¡ŒåŒ…è£…æˆå¯¹è±¡è¿”å›ã€‚</p>
<p>è¢«è£…é¥°çš„å‡½æ•°ä¸éœ€è¦æœ‰å‡½æ•°ä½“ï¼Œå¯¹å‡½æ•°ä½“ä¸åšå¤„ç†ã€‚è¢«è£…é¥°çš„å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸éœ€è¦åŠ ä¸Šç±»å‹æ³¨é‡Šï¼Œå½“ç„¶åŠ äº†æ›´ä¸¥è°¨ã€‚</p>
<p>2022-01-29</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[papadb ä½¿ç”¨æ–‡æ¡£ #1ã€å®‰è£…å’Œé…ç½®é¡¹]]></title>
        <id>https://chenzdna.github.io/post/papadb-shi-yong-wen-dang-1an-zhuang-he-pei-zhi-xiang/</id>
        <link href="https://chenzdna.github.io/post/papadb-shi-yong-wen-dang-1an-zhuang-he-pei-zhi-xiang/">
        </link>
        <updated>2022-01-25T20:22:06.000Z</updated>
        <content type="html"><![CDATA[<h1 id="å®‰è£…">å®‰è£…</h1>
<p>pypadb ä¾èµ–äº DBUtilsã€pydandicã€PyMySQLï¼Œå»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼Œé¿å…æ±¡æŸ“å…¨å±€ä¾èµ–ã€‚</p>
<p><code>pip install pypadb</code></p>
<h1 id="æ•°æ®åº“è¿æ¥é…ç½®">æ•°æ®åº“è¿æ¥é…ç½®</h1>
<p>æ•°æ®åº“è¿æ¥ç”¨çš„æ˜¯ pymysqlï¼Œä½¿ç”¨ DBUtils ä½œä¸ºè¿æ¥æ± ã€‚</p>
<p>pypadb.conf.db_configurer é‡Œæœ‰ä¸€å † setterï¼Œæ˜¯ç”¨æ¥åšæ•°æ®åº“è¿æ¥æ± é…ç½®çš„ã€‚</p>
<p>ç”±äºç¯‡å¹…åŸå› å°±ä¸å†™æ–¹æ³•å…·ä½“å†…å®¹äº†ï¼Œè¿”å›çš„æ˜¯ selfï¼Œæ‰€ä»¥æ”¯æŒé“¾å¼è°ƒç”¨çš„å†™æ³•ã€‚</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>é…ç½®é¡¹</th>
<th>é»˜è®¤å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>set_creator</td>
<td>é…ç½®è¿æ¥æ•°æ®åº“çš„æ¨¡å—</td>
<td>pymysql</td>
</tr>
<tr>
<td>set_maxconnections</td>
<td>è¿æ¥æ± å…è®¸çš„æœ€å¤§è¿æ¥æ•°ï¼Œ0 å’Œ None è¡¨ç¤ºä¸é™åˆ¶è¿æ¥æ•°</td>
<td>6</td>
</tr>
<tr>
<td>set_mincached</td>
<td>åˆå§‹åŒ–æ—¶ï¼Œé“¾æ¥æ± ä¸­è‡³å°‘åˆ›å»ºçš„ç©ºé—²çš„é“¾æ¥ï¼Œ0 è¡¨ç¤ºä¸åˆ›å»º</td>
<td>2</td>
</tr>
<tr>
<td>set_maxcached</td>
<td>é“¾æ¥æ± ä¸­æœ€å¤šé—²ç½®çš„é“¾æ¥ï¼Œ0å’ŒNoneä¸é™åˆ¶</td>
<td>5</td>
</tr>
<tr>
<td>set_blocking</td>
<td>è¿æ¥æ± ä¸­å¦‚æœæ²¡æœ‰å¯ç”¨è¿æ¥åï¼Œæ˜¯å¦é˜»å¡ç­‰å¾…ã€‚Trueï¼Œç­‰å¾…ï¼›Falseï¼Œä¸ç­‰å¾…ç„¶åæŠ¥é”™</td>
<td>True</td>
</tr>
<tr>
<td>set_maxusage</td>
<td>ä¸€ä¸ªé“¾æ¥æœ€å¤šè¢«é‡å¤ä½¿ç”¨çš„æ¬¡æ•°ï¼ŒNoneè¡¨ç¤ºæ— é™åˆ¶</td>
<td>None</td>
</tr>
<tr>
<td>set_setsession</td>
<td>å¼€å§‹ä¼šè¯å‰æ‰§è¡Œçš„å‘½ä»¤åˆ—è¡¨</td>
<td>[]</td>
</tr>
<tr>
<td>set_host</td>
<td>æ•°æ®åº“æœåŠ¡ç«¯ä¸»æœºå</td>
<td>127.0.0.1</td>
</tr>
<tr>
<td>set_port</td>
<td>æ•°æ®åº“æœåŠ¡ç«¯ç«¯å£å·</td>
<td>3306</td>
</tr>
<tr>
<td>set_user</td>
<td>æ•°æ®åº“ç™»å½•ç”¨æˆ·</td>
<td>root</td>
</tr>
<tr>
<td>set_password</td>
<td>æ•°æ®åº“ç™»å½•å¯†ç </td>
<td>123456</td>
</tr>
<tr>
<td>set_database</td>
<td>æ•°æ®åº“å</td>
<td>test</td>
</tr>
<tr>
<td>set_charset</td>
<td>æ•°æ®åº“è¿æ¥ä½¿ç”¨çš„å­—ç¬¦ç¼–ç </td>
<td>utf8</td>
</tr>
<tr>
<td>set_cursor</td>
<td>æ•°æ®åº“æŸ¥è¯¢ä½¿ç”¨çš„æŒ‡é’ˆç±»å‹</td>
<td>pymysql.cursors.DictCursor</td>
</tr>
</tbody>
</table>
<p>ä½¿ç”¨ DictCursor ä½œä¸ºé»˜è®¤æŒ‡é’ˆçš„åŸå› æ˜¯ DictCursor ä¼šæŠŠæ¯ä¸€è¡Œçš„æŸ¥è¯¢ç»“æœä½œä¸º dict è¿”å› <code>{'åˆ—å':'æ•°æ®'}</code>ï¼Œè¡¨ç»“æ„æ”¹å˜æ—¶éœ€è¦æ”¹åŠ¨çš„ä»£ç å°‘å¾ˆå¤šã€‚</p>
<p>é…ç½®å®Œåè¦è°ƒç”¨ <code>end</code> æ–¹æ³•ï¼Œåˆå§‹åŒ–è¿æ¥æ± ã€‚</p>
<p>å®Œæ•´çš„é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">from pypadb.conf.db_configurer import db_configurer, DbConfigurer

db_configurer \
    .set_host('localhost') \
    .set_user('root') \
    .set_password('123456') \
    .set_database('test') \
    .end()

# æˆ–è€…è‡ªå·± new ä¸€ä¸ªå¯¹è±¡
DbConfigurer() \
    .set_host('localhost') \
    .set_user('root') \
    .set_password('123456') \
    .set_database('test') \
    .end()
</code></pre>
<h1 id="æ•°æ®è¡¨é…ç½®ä»…å¯¹è±¡æ•°æ®æ˜ å°„éƒ¨åˆ†ä¼šç”¨åˆ°">æ•°æ®è¡¨é…ç½®ï¼ˆä»…å¯¹è±¡æ•°æ®æ˜ å°„éƒ¨åˆ†ä¼šç”¨åˆ°ï¼‰</h1>
<pre><code class="language-python">from pydantic import BaseModel
from pypadb.conf.table_configurer import tables


class User(BaseModel):
    id: int
    account: str
    stuffs: list = []

# å®ä½“ç±»å¿…é¡»ç»§æ‰¿ pydantic çš„ BaseModel
class Stuff(BaseModel):
    user_id: int
    name: str
    count: int

# çœŸæ­£çš„é…ç½®éƒ¨åˆ† è¡¨å=ç±»å
tables.init_tables(user=User, stuff=Stuff)
# ä½¿ç”¨è¡¨æ ¼é…ç½®çš„å†…å®¹
tables.user.select_one()
tables.stuff.select_many()
</code></pre>
<p>ä½¿ç”¨æ•°æ®è¡¨å°±ä¸éœ€è¦å¦å¤–å†™ä»€ä¹ˆç±»æˆ–è€…æ¨¡å—ï¼Œè¡¨å’Œç±»çš„æ˜ å°„é…å¥½åç›´æ¥æŠŠè¡¨ä½œä¸º tables çš„å±æ€§è¿›è¡Œè°ƒç”¨ã€‚</p>
<p>2022-01-26</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å…³äº pypadb çš„ä¸€äº›ç»†èŠ‚ #1]]></title>
        <id>https://chenzdna.github.io/post/guan-yu-pypadb-de-yi-xie-xi-jie-1/</id>
        <link href="https://chenzdna.github.io/post/guan-yu-pypadb-de-yi-xie-xi-jie-1/">
        </link>
        <updated>2022-01-22T19:01:07.000Z</updated>
        <content type="html"><![CDATA[<h1 id="åå­—">åå­—</h1>
<p>pypadbï¼Œå¬èµ·æ¥æŒºæ€ªçš„ï¼Œå¿µä¹Ÿä¸å¥½å¿µï¼Œä½†è¿™ä¸ªåå­—æ˜¯å¯ä»¥è§£é‡Šçš„ã€‚å„ä½åº”è¯¥éƒ½å¬è¯´è¿‡ JPAï¼ˆJava Persistence APIï¼ŒJava æŒä¹…å±‚åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ <s>å¥½å‡ æŠŠé•¿</s>ï¼‰ï¼Œæ˜¯ä¸€ä¸ªæ–°çš„ Java ORMï¼ˆObject Relational Mappingï¼Œå¯¹è±¡-å…³ç³»æ˜ å°„ï¼‰è§„èŒƒï¼ˆç°åœ¨æ¥è¯´ä¹Ÿä¸æ˜¯å¾ˆæ–°ï¼Œä½†æ˜¯å¾ˆå¥½ç”¨ï¼‰ã€‚æ‰€ä»¥pypadb çš„ pypa å°±æ˜¯ Python Persistence APIã€‚ä¸ºå•¥è¦åŠ ä¸€ä¸ª db å‘¢ï¼Œå› ä¸º PyPI ï¼ˆPython Package Indexï¼ŒPython åŒ…çš„ä»“åº“ï¼‰é‡Œé¢å·²ç»æœ‰ä¸€ä¸ªåŒ…å« pyPA äº†ï¼Œæ‰€ä»¥å°±åŠ äº†ä¸€ä¸ª db è¡¨ç¤º Databaseï¼Œå’±ä»¬æ˜¯å’Œæ•°æ®åº“æ‰“äº¤é“çš„ã€‚</p>
<h1 id="åˆè¡·">åˆè¡·</h1>
<p>å»å¹´æäº†ä¸€æ®µæ—¶é—´çš„ QQ æœºå™¨äººï¼Œç”¨çš„æ˜¯åŸºäº Python çš„æ¡†æ¶ nonebotã€‚åŠŸèƒ½æ¸æ¸åœ°åšå¤šäº†ï¼Œéš¾å…è¦ç”¨åˆ°æ•°æ®åº“ã€‚æ­£å¥½é‚£æ—¶å€™å­¦äº† Mybatisï¼Œæƒ³ç€åœ¨ Python é‡Œæœ‰æ²¡æœ‰ Mybatis ä¸€æ ·çš„ä¸œè¥¿ï¼Œæ‰¾äº†ä¸€åœˆå‘ç°è™½ç„¶è¯´æ˜¯æœ‰å¼€å‘è€…å¼€å‘äº†æ›´æ–¹ä¾¿åœ°æ“ä½œæ•°æ®åº“çš„åŒ…ï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡è¾¾åˆ°æˆ‘çš„å¿ƒç†é¢„æœŸã€‚äºæ˜¯ pypadb çš„å¼€å‘å°±è¢«æä¸Šäº†æ—¥ç¨‹ã€‚</p>
<p>ç„¶åå°±æ˜¯å¯’å‡å¼€å§‹è¯•ç€ç”¨äº† Mybatis Plusï¼Œåœ¨ Spring Boot é‡Œå…¼å®¹ Mybatisï¼Œè€Œä¸”å†™ä¸€äº›ç®€å•çš„ CURDï¼ˆCreate Update Retrieve Deleteï¼Œæ•°æ®åº“çš„æ“ä½œï¼‰æ¯” Mybatis æ›´å¥½ç”¨ï¼Œäºæ˜¯åœ¨ pypadb é‡Œä¹ŸåŠ ä¸Šäº† Mybatis Plus çš„å†™æ³•ã€‚</p>
<h1 id="ä¸€äº›åæ§½">ä¸€äº›åæ§½</h1>
<p>é¦–å…ˆæ˜¯ Python çš„ç±»å‹æ³¨è§£ï¼Œæ³›å‹å’Œåå°„ã€‚Python ä½œä¸ºä¸€ä¸ªåŠ¨æ€å¼ºç±»å‹è¯­è¨€ï¼Œç±»å‹æ³¨è§£å’Œæ³›å‹åœ¨ç¼–è¯‘å’Œè¿è¡ŒæœŸæ¯«æ— æ„ä¹‰ï¼Œå”¯ä¸€çš„ç”¨å¤„æ˜¯åœ¨æ•²ä»£ç çš„æ—¶å€™ç»™ç±»å‹æç¤ºè€Œå·²ã€‚ä½†æ˜¯è¿™ç±»å‹å•Šï¼Œååˆ†çš„çè´µã€‚æ—©æœŸä¸€äº›åŒ… IDE æ²¡æœ‰ç±»å‹æç¤ºï¼Œå†™èµ·æ¥è·Ÿåƒäº†ğŸ’©ä¸€æ ·ï¼Œæ‰€ä»¥è¿˜æ˜¯è¡¨ä¸Šç±»å‹æ¯”è¾ƒå¥½ã€‚ä½†æ˜¯å³ä½¿ä½ èƒ½æ ‡çš„åœ°æ–¹éƒ½è¡¨ä¸Šäº†ç±»å‹ï¼Œè¿˜æ˜¯æœ‰äº›åœ°æ–¹ IDE è§£æä¸äº†ï¼Œä»¥åå†ç»†è¯´ã€‚</p>
<p>ä¸ Java ä¸ä¸€æ ·ï¼ŒPython çš„æ³›å‹å®Œå…¨å˜æˆäº†å¦å¤–ä¸€ç§ç±»å‹ GenericAlias ï¼Œè¦åˆ¤æ–­ä¸€ä¸ªæ³›å‹çš„ list åˆ°åº•æ˜¯å“ªç§ç±»å‹ï¼Œåªèƒ½æŠŠæ‰€æœ‰çš„æ³›å‹éƒ½ç»™æ¯”è¾ƒä¸€é <s>å¥½å‚»é€¼</s>ã€‚æ®Šé€”åŒå½’ï¼ŒPython æ‹¿ä¸åˆ°æ³›å‹ç±»é‡Œçš„æ³›å‹ï¼Œæ‰€ä»¥å¹²è„†ç›´æ¥æŒ‡å®šä¸€ä¸ªç±»ä½œä¸ºè¦å¤„ç†çš„æ³›å‹äº†ï¼Œè¿™æ ·è€¦åˆåº¦ä¼šå¢åŠ ï¼Œæ‰€ä»¥ç”¨äº† pydantic æ¥è§£è€¦ã€‚</p>
<p>è‡³äºåå°„ï¼Œæˆ‘è§‰å¾—è¿˜è¡Œã€‚åŸºæœ¬çš„åŠŸèƒ½éƒ½åšåˆ°äº†ï¼Œå¯ä»¥æ‹¿åˆ°å‡½æ•°çš„ç±»å‹æ³¨è§£å’Œè¿”å›å€¼çš„ç±»å‹æ³¨è§£ï¼Œå°è£…æˆå·¥å…·æ¨¡å—åç”¨èµ·æ¥è¿˜æ˜¯æŒºå¥½çš„ã€‚</p>
<h1 id="the-end">The End</h1>
<p>æäº†å‡ å¤©ï¼Œæ‰æŠŠæŸ¥è¯¢æå‡ºæ¥ã€‚å®é™…ä¸Š JPA è¿™ç§ä¸œè¥¿æ˜¯ç®€åŒ–å¢åˆ æ”¹çš„ï¼Œåªæ˜¯æˆ‘è§‰å¾—å†™æŸ¥è¯¢æ¯”è¾ƒå¥½ç©æ‰€ä»¥å°±å…ˆæŠŠæŸ¥è¯¢çš„å†™äº†ã€‚</p>
<p>è¯è¯´ pypadb ä¹Ÿä¸ç®— ORM çš„æ¡†æ¶å•Šï¼Œæˆ‘æŠŠ ORM çš„éƒ¨åˆ†éƒ½äº¤ç»™ pydantic åšäº†ã€‚å®ƒåº”è¯¥ç®—å•¥å‘¢ã€‚</p>
<p>2022-01-23</p>
]]></content>
    </entry>
</feed>